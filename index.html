<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Lightning Hoarder : Bitcoin Lightning Network Node</title>
		<meta name="referrer" content="no-referrer">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<link rel="icon" href="./logo.svg" type="image/svg+xml">
		<link rel="alternate icon" href="./favicon.png" type="image/png">
		<link href="https://ln.lightninghoarder.net/" rel="canonical">
		<link rel="preload" href="./cytoscape.min.js" as="script">
		<link rel="preload" href="./qrcode.min.js" as="script">
		<link href="./bootstrap.min.css" rel="stylesheet">
		<style type="text/css">
body {
	background: #ddd;
	z-index : 999;
}

h1 {
	font-size: 55px;
}

h1 a {
	text-decoration: none !important;
	color: #f2a900;
	text-shadow: 0px 1px 2px #000, 0px -1px 2px #000, 1px 0px 2px #000, -1px 0px 2px #000;
}

h1 a:hover {
	color: #f2a900;
}

h1 img {
	position: relative;
	top: -5px;
}

textarea {
	width: 100%;
	height: 60px;
	font-size: 12px;
}

textarea#clearnet-field {
	height: 40px;
}

.jumbotron {
	background-color: transparent;
}

main {
	display: block;
}

p a {
	text-decoration: underline;
}

p a.btn {
	text-decoration: none;
}

object.inline-icon {
	height: 1em;
	position: relative;
	top: .125em;
}
svg.inline-icon, img.inline-icon {
	height: 1em;
}

.info-text {
	text-decoration: underline;
	text-decoration-style: dotted;
}

#cy {
    position: fixed;
    width: 100%;
    height: 100%;
    z-index: -1;
    opacity: 0.7;
}

main {
	background: rgba(221, 221, 221, 0.7);
}

#qrcode canvas, #qrcode img{
	background: rgb(255, 255, 255);
	image-rendering: pixelated;
	width: 100%;
}
		</style>
	</head>
	<body>
	<div id="cy"></div>
		<header class="jumbotron text-center">
			<h1><a href="https://ln.lightninghoarder.net/" rel="home"><object type="image/svg+xml" data="./logo.svg" class="inline-icon"></object> Lightning Hoarder</a></h1>
		</header>
		<main class="container mb-0">
			<div class="row justify-content-center">
				<article class="col-sm-8 flex-first flex-md-unordered">
					<h3>Bitcoin Lightning Network Node</h3>
					<p>The <strong>Lightning Network</strong> is a second layer payment protocol that operates on top of <strong>Bitcoin</strong>. It enables instant and cheap off-chain transactions between participating nodes. </p>
					<p>To use the Lightning Network, every end user must be connected to enough <strong>well-connected nodes</strong>. That ensures that there will be network paths for every Bitcoin payment.</p>
					<p><strong>Lightning Hoarder</strong> is a volunteer-run mainnet lightning node. It is trying to become well-connected through balancing and community initiatives like the <span title="By linking Routing Nodes together in Liquidity Triangles, we're weaving together a massive cyclic superhub called the Reddit Megahub!" class="info-text">Reddit Megahub Triangle</span> on <a href="https://www.reddit.com/r/TheLightningNetwork/" target="_blank">/r/TheLightningNetwork</a>. This node tries to use latest LND releases with well-configured settings.</p>
					<p>This node is run on a <span title="High Availability" class="info-text">HA</span> cluster, on reliable NVMe pools on <a href="https://docs.ceph.com/en/latest/rbd/index.html" target="_blank" title="Ceph block devices are thin-provisioned, resizable, and store data striped over multiple OSDs. Ceph block devices leverage RADOS capabilities including snapshotting, replication and strong consistency" class="info-text">Ceph rbd</a>, with backups in place. It is backed by batteries and split power circuits from other equipment to maintain uptime.</p>
					<p>Fees are automatically adjusted to prefer a balanced channel over time. If you are part of the Reddit Megahub, lower fees are applied.</p>
					<p>Feel free to <strong>open a channel</strong> to this node with the information on the sidebar.</p>
					<hr>
					<h4>Features</h4>
					<p>
						<ul>
							<li>Using latest version of <em>LND</em></li> 
							<li>Tor & Clearnet addresses</li>
							<li>Channels will be kept open as long as possible</li>
							<li><span title="Currently using charge-lnd for fee management" class="info-text">Auto-scaled channel fees</span>, low where it matters</li>
							<li>Low channel commitment <span title="Currently 1%" class="info-text">reserve</span></li>
							<li><strong><a href="https://github.com/lightningnetwork/lnd/blob/master/docs/watchtower.md" target="_blank" class="info-text" title="Watchtowers will automatically handle the recovery and punishment process for users in the case of a channel breach while disconnected from the internet for an extended period of time
">Watchtower-backed</a></strong> channels</li>
							<li><strong><a href="https://bitcoinops.org/en/topics/multipath-payments/" target="_blank" class="info-text" title="Multipath payments are LN payments split into two or more parts and sent using a different path for each part.

">AMP / Multipath payments</a> supported</strong>
							<li><strong><a href="https://bitcoinops.org/en/topics/anchor-outputs/" target="_blank" class="info-text" title="Anchor outputs are special outputs in LN commitment transactions that are designed to allow the transaction to be fee bumped">Anchor outputs</a> supported</strong></li>
							<li><strong><a href="https://bitcoinops.org/en/topics/large-channels/" target="_blank" class="info-text" title="Large channels are LN payment channels where both peers send the parameter option_support_large_channel and which can be funded with a balance over 0.16777216 BTC.

">WUMBO channels</a> supported</strong></li>
							<li><span title="ECONOMIC estimate mode, current target of 24 blocks from co-op close" class="info-text">Economical estimate</a> for co-operative closes</li>
							<li><a href="https://bitcoinops.org/en/topics/spontaneous-payments/" class="info-text" title="Spontaneous payments is the ability of one LN node to pay another node without receiving an invoice first">KeySend / Spontaneous payments</a> enabled (send some sats!)</li>
						</ul>
					</p>
					<hr>
					<h4>Contact Details</h4>
					<p><a href="https://github.com/WeebDataHoarder/ln.lightninghoarder.net/issues/new/choose" class="btn btn-light" target="_blank"><object type="image/svg+xml" data="./github.svg" class="inline-icon"></object> Contact Node Operator on GitHub</a> <a href="https://yalls.org/hashcash/37c7df7f-5132-4176-aa00-bb65900a98d1/" class="btn btn-dark" target="_blank"><svg class="inline-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M296 160H180.6l42.6-129.8C227.2 15 215.7 0 200 0H56C44 0 33.8 8.9 32.2 20.8l-32 240C-1.7 275.2 9.5 288 24 288h118.7L96.6 482.5c-3.6 15.2 8 29.5 23.3 29.5 8.4 0 16.4-4.4 20.8-12l176-304c9.3-15.9-2.2-36-20.7-36z"></path></svg> Contact Node Operator on Y'alls</a></p>
					<p>You can contact for channel requests, force-close requests, any manual recovery instructions or other issues with this node.</p>
					<p>Part of the <a href="https://www.node-recovery.com/" target="_blank" class="info-text">Node Recovery initiative</a>.</p>
					<hr>
					<h4>Other Resources</h4>
					<p><a href="./known-lnd-watchtowers.txt" class="btn btn-dark">ðŸ‘€ Working Watchtower List <em>(lnd)</em></a></p>
				</article>
				<aside class="col-sm-4 flex-first flex-md-unordered">
					<h3>Node Information (mainnet)</h3>
					<p id="qrcode"><img src="./qrcode.png"/></p>
					<p><textarea id="tor-field" readonly="" onclick="this.focus();this.select()">02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae@bllbkxh4k372lttsdnwgm54csziw3sham5y3qbqn5yq2fo3pm2gpapqd.onion:9735</textarea>
					<input type="button" value="Copy TOR" onclick="copyField(&#39;code&#39;);this.disabled=true;this.value=&#39;Copied&#39;;"></p>
					<p style="display: none"><textarea id="clearnet-field" readonly="" onclick="this.focus();this.select()"></textarea>
					<input type="button" value="Copy Clearnet" onclick="copyField(&#39;code&#39;);this.disabled=true;this.value=&#39;Copied&#39;;"></p>
					<p>Tor connection preferred.</p>
					<hr/>
					<p>Minimum channel size: 250,000 satoshi</p>
					<p>Recommended channel size: 1,000,000+ satoshi</p>
					<div id="extra-information"></div>
					<p>
						<a href="https://1ml.com/node/02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae" target="_blank" class="btn btn-sm btn-block" style="color: #fff; background-color: #0078b3; border-color: #0078b3;"><img src="./1ml.png" class="inline-icon"/> View Node on 1ML</a>
						<a href="https://amboss.space/node/02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae" target="_blank" class="btn btn-sm btn-block btn-dark">View Node on <object type="image/svg+xml" data="./amboss.svg" class="inline-icon" style="color: #FFF" alt="Amboss"></object></a>
						<a href="https://terminal.lightning.engineering/#/02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae" target="_blank" class="btn btn-sm btn-block btn-info"><object type="image/svg+xml" data="./terminal.svg" class="inline-icon" style="color: #FFF"></object> View Node on Lightning Terminal</a>
						<a href="https://explorer.acinq.co/n/02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae" target="_blank" class="btn btn-sm btn-block btn-secondary"><object type="image/svg+xml" data="./acinq.svg" class="inline-icon"></object> View Node Graph on ACINQ Explorer</a>
					</p>
				</aside>
			</div>
		</main>
		<footer class="jumbotron text-center">
			<p><a href="https://github.com/WeebDataHoarder/ln.lightninghoarder.net" target="_blank">Site source on GitHub</a> - Read more about Lightning Network on <a href="https://docs.lightning.engineering/the-lightning-network/lightning-overview" target="_blank">docs.lightning.engineering</a>, <a href="https://bitcoinops.org/en/topics/" target="_blank">Bitcoin Optech</a> or <a href="https://www.lopp.net/lightning-information.html" target="_blank">lopp.net</a></p>
		</footer>
		
		<script type="text/javascript" src="./qrcode.min.js"></script>
		<script type="text/javascript">
			const NODE_PUBLIC_KEY = "02a4002deca0ad6781b1c55ea5c692faae768fef44e1997c5723cb5393a98709ae";
			function copyField(id) {
				var field = document.getElementById(id);
				field.focus();
				field.setSelectionRange(0, field.value.length);
				document.execCommand("copy");
			}
			
			function getQRCode(content){
				let canvas = document.createElement('canvas');
				try {
				    bwipjs.toCanvas(canvas, {
				    	bcid: "qrcode",
				    	text: content,
				    	padding: 2,
					backgroundcolor: "#ffffff",
					eclevel: "L"
				    });
				    return canvas;
				} catch (e) {
				    return null;
				    // `e` may be a string or Error object
				}
			}
			

			
			const el = getQRCode(document.getElementById("tor-field").value);	
			document.getElementById("qrcode").replaceChildren(el);
			
			document.getElementById("tor-field").addEventListener("click", () => {
				document.getElementById("qrcode").replaceChildren(getQRCode(document.getElementById("tor-field").value));
			});
			document.getElementById("clearnet-field").addEventListener("click", () => {
				document.getElementById("qrcode").replaceChildren(getQRCode(document.getElementById("clearnet-field").value));
			});
			
			async function fetchJson(url){
				const response = await fetch(url, {
					method: "GET",
					mode: "cors",
					credentials: "omit",
					referrerPolicy: "no-referrer"
				});
				return await response.json();
			}
			
			function fillInformation(data){
				const section = document.getElementById("extra-information");
				{
					const p = document.createElement("p");
					p.append("Total channel capacity: " + (data.total_capacity / 100000000).toFixed(8) + " BTC");
					section.append(p);
				}
				{
					const p = document.createElement("p");
					p.append("Total channel peers: " + (data.total_peers));
					section.append(p);
				}
				{
					const field = document.getElementById("clearnet-field");
					for(let address of data.addresses){
						if(address.match(/\.onion:/) === null){
							field.value = NODE_PUBLIC_KEY + "@" + address;
							field.parentElement.style.display = "";
							break;
						}
					}
				}
			}
			
			fetchJson("https://ln-scores.prod.lightningcluster.com/availability/v1/btc_summary.json").then((data) => {
				let nodeData = null;
				
				for(let _class of ["scored", "stable", "unconnectable", "unstable"]){
					if(NODE_PUBLIC_KEY in data[_class]){
						nodeData = data[_class][NODE_PUBLIC_KEY];
						nodeData._class = _class;
						break;
					}
				}
				
				if(nodeData !== null){
					fillInformation(nodeData);
				}
			});
		</script>
		<script type="text/javascript" src="./cytoscape.min.js"></script>
		<script type="text/javascript">
		function invertColor(hex, bw) {
		    if (hex.indexOf('#') === 0) {
			hex = hex.slice(1);
		    }
		    // convert 3-digit hex to 6-digits.
		    if (hex.length === 3) {
			hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];
		    }
		    if (hex.length !== 6) {
			throw new Error('Invalid HEX color.');
		    }
		    var r = parseInt(hex.slice(0, 2), 16),
			g = parseInt(hex.slice(2, 4), 16),
			b = parseInt(hex.slice(4, 6), 16);
		    if (bw) {
			// http://stackoverflow.com/a/3943023/112731
			return (r * 0.299 + g * 0.587 + b * 0.114) > 186
			    ? '#000000'
			    : '#FFFFFF';
		    }
		    // invert color components
		    r = (255 - r).toString(16);
		    g = (255 - g).toString(16);
		    b = (255 - b).toString(16);
		    // pad each with zeros and return
		    return "#" + padZero(r) + padZero(g) + padZero(b);
		}
		Promise.all([
		  fetchJson("https://explorer.acinq.co/nodes"),
		  fetchJson("https://explorer.acinq.co/channels")
		]).then((dataArray) => {
			const wantedNodes = {};
			wantedNodes[NODE_PUBLIC_KEY] = true;
			const nodes = [];
			const edges = [];
			for(let channel of dataArray[1]){
				if(channel.source === NODE_PUBLIC_KEY){
					edges.push({data: channel});
					wantedNodes[channel.target] = true;
				}else if (channel.target === NODE_PUBLIC_KEY){
					edges.push({data: channel});
					wantedNodes[channel.source] = true;
				}
			}
			
			for(let channel of dataArray[1]){
				if(channel.source in wantedNodes && channel.target in wantedNodes){
					const isMine = (channel.source === NODE_PUBLIC_KEY || channel.target === NODE_PUBLIC_KEY);
					channel.size = isMine ? 2 : 1;
					channel.color = isMine ? "#999" : "#bbb";
					edges.push({data: channel});
				}
			}
			
			for(let node of dataArray[0]){
				if(node.id in wantedNodes){
					nodes.push({data: {
						id: node.id,
						alias: node.alias,
						color: node.color,
						textColor: invertColor(node.color.substr(1), true),
						isseed: node.id === NODE_PUBLIC_KEY
					}});
				}
			}
			
			const cy = cytoscape({
				container: document.getElementById("cy"),
				boxSelectionEnabled: false,
				autounselectify: true,
				elements: {
					nodes: nodes,
					edges: edges
				},
				style: [
					    {
					      selector: 'node',
					      style: {
					      	'text-valign': 'center',
						'color': 'data(textColor)',
						'text-outline-width': 1,
						'text-outline-color': 'data(color)',
						'background-color': 'data(color)',
						'content': 'data(alias)'
					      }
					    },

					    {
					      selector: 'edge',
					      style: {
						'width': 'data(size)',
						'line-color': 'data(color)',
					      }
					    }
					],
				layout: {
					name: "random",
					animate: false
				}
			});
		});
		</script>
</body>


</html>
